# Effective_Matrix_Keypad
Алгоритм эффективного использования матричной клавиатуры используя двустороннюю передачу данных

Использование матричных клавиатур свзяано с большим количеством требуемых портов. Для клавиатуры 4*4 необходимо 4 входа и 4 выхода. Таким образом одна клавиатура занимает почти все свободные цифровые выходы Arduino Nano. В представленном примере показан калькулятор, клавиаура которого использует всего 4 порта. В общем случае количество нужных портов равно количеству портов строк или столбцов, смотря чего больше. 

В предавтленном примере один ряд сканируется с применением D-триггеров, которые являются элементами памяти. Алгоритм работы функции scanrow таков: 

•	Инициализируем результат, по умолчанию равный спецсимволу, значащему что в ряду нет нажатых кнопок. 
•	Установим пин текущего ряда на выход. 
•	Подадим высокий уровень сигнала на этот пин. Теперь при нажатии кнопки высокий сигнал пойдет на выход. 
•	Подать прямоугольный импульс на двухтактные D-триггеры, которые сохранят свои текущие положения, и если кнопка на одном из столбцов была нажата, триггер перейдет в высокий уровень. 
•	Снять высокий уровень с выхода. 
•	Перевести все выходы в режимы входа 
•	Проверить наличие высокого уровня сигнала на выходах D-триггеров, если высокий уровень сигнала есть, сохраним индекс столбца как того, в котором нажата кнопка. 
•	Перевести все входы обратно в выходы
•	Задать на них низкий уровень сигнала. Последние два пункта выглядят не столь значительными, но они нужны для того, чтобы не допустить неопределённого поведения входа, на котором был высокий уровень сигнала и который перевели в режим выхода. 
•	Дать задержку для того, чтобы все триггеры точно сбросились. 
•	Вернуть результат – номер столбца, в котором нажата кнопка или спецсимвол 

далее применяя этот алгоритм ко всем рядам получаем динамическое сканирование клавиатуры, однозначно задавая позицию кнопки в строке и стоблце



